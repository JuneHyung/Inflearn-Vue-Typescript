# 뷰 플러그인과 외부 라이브러리 타입 정의

## 프로젝트 생성 및 라이브러리 안내

외부라이브러리를 플러그인화 하고, 그 플로그인의 타입정의 하는 방법을 알아보자.

```shell
vue create vue-chart
```

![create-chart-project](./readme_images/13_create-chart-project.png)

생성 후 vue-chart로 이동하여 `npm run serve`로 잘 동작하는지 확인.

차트 라이브러리로는 Chart.js를 사용.



## 차트 라이브러리 설치 및 실행 확인

[Chart.js](https://www.chartjs.org/)

```shell
npm i chart.js --save
```

확인해보자.



우선 App.vue에서 ts자동완성 명령어를 이용해 새로 작성.

그리고 mounted에 chart.js에서 예제 파일을 붙여넣음.<br/>(잘 되지않아 커뮤니티에 검색해보니 예제코드를 붙여주신분이 있어 해당 코드를 사용.)

```vue
<template>
  <div>
    <canvas id="myChart"></canvas>
  </div>
</template>
<script lang="ts">
import Vue from "vue";
import { ChartConfiguration } from "chart.js";
import Chart from "chart.js/auto";

export default Vue.extend({
  mounted() {
    const labels = ["January", "February", "March", "April", "May", "June"];
    const data = {
      labels: labels,
      datasets: [
        {
          label: "My First dataset",
          backgroundColor: "rgb(255, 99, 132)",
          borderColor: "rgb(255, 99, 132)",
          data: [0, 10, 5, 2, 20, 30, 45],
        },
      ],
    };
    const config: ChartConfiguration = {
      type: "line",
      data,
      options: {},
    };
    const ctx = (
      document.getElementById("myChart") as HTMLCanvasElement
    ).getContext("2d") as CanvasRenderingContext2D;
    var myChart = new Chart(ctx, config);
  },
});
</script>
<style scoped></style>
```

`document.getElementById("myChart").getContext("2d");` 여기서 에러가 발생할텐데 getContext앞의 요소가 canvas요소인것을 추론할 수 있게 해주어야한다.

가장 간단한 방법으로는 HTMLCanvasElement라고 선언해준다.

```typescript
 const ctx = (
      document.getElementById("myChart") as HTMLCanvasElement
    ).getContext("2d");
```



## 차트 라이브러리 에러 설명 및 플러그인화

chart.js라이브러리를 typescript로 인식하지 못하는 문제가 발생하고 있다.

vue-chart가 루트레벨로 보이게 워크스페이스를 다시 열어주자.

일단 새로운 선언파일이 필요하다고 에러가 출력되고 있다.

어떤 에러인지 살펴보았으니 우선 chart.js의 플러그인화를 진행해보자.

```typescript
// src/plugins/ChartPlugin.ts
import Chart from "chart.js";

export default {
  install(Vue) {
    Vue.prototype.$_Chart = Chart;
  },
};

// App.vue
// new this.$_Chart();
```

App.vue에서는 주석된 부분처럼  차트를 생성할 수 있게 된다.



## 차트 플러그인 타입 에러 해결

install부분 부터 살펴보자.

```typescript
install(Vue) {
    Vue.prototype.$_Chart = Chart;
},
```

Vue는 Vue 내부적으로 제공하는 VueConstructor를 사용하면된다.

그리고 강의에서는 

```typescript
 Vue.prototype.$_Chart
```

이부분이 typescript 내부의 규칙에 의해서 camelCase가 아니라는 에러가난다.

eslint에 rules에 해당내용을 off로해주면 된다. (설정값으로는 off/warn/error가 있다.)

```typescript
"@typescript-eslint/camelcase": "off",
```

